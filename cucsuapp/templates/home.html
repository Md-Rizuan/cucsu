{% extends 'base.html' %}
{% load static %}

{% block title %}CUCSU Election 2025 - চট্টগ্রাম বিশ্ববিদ্যালয় কেন্দ্রীয় ছাত্র সংসদ নির্বাচন{% endblock %}


{% block content %}
<div class="container my-5">
    
    <!-- Hero Section -->
    <header class="text-center mb-5">
        <h1 class="display-4 fw-bold text-primary mb-4">
            চট্টগ্রাম বিশ্ববিদ্যালয় কেন্দ্রীয় ছাত্র সংসদ নির্বাচন (চাকসু)
        </h1>
        <h2 class="h3 text-success fw-semibold mb-3">
            ও হল সংসদ নির্বাচন – ২০২৫
        </h2>
        <p class="lead text-warning fw-medium">
            প্রার্থীদের তালিকা এবং ইশতেহার তালিকা দেখুন । 
        </p>
        <p class="lead text-danger fw-medium">
            ভোট দিন আপনার পছন্দের প্রার্থীকে। 
            
        </p>

    </header>

    <!-- Hero Banner Section -->
    <section class="row align-items-center mb-5">
        <!-- Left: Image -->
        <div class="col-12 col-lg-6 text-center text-lg-start mb-4 mb-lg-0">
            <img src="{% static 'cucsuapp/images/cucsu.jpg' %}" 
                 alt="CUCSU Banner" 
                 class="img-fluid rounded-3 shadow-lg hover-shadow-glow" 
                 style="max-width:100%; height:auto;">
        </div>

        <!-- Right: Text -->
        <div class="col-12 col-lg-6">
            <div class="card shadow-sm border-0 university-card">
                <div class="card-body p-4">
                    <p class="fs-5 mb-3">
                        চট্টগ্রাম বিশ্ববিদ্যালয় কেন্দ্রীয় ছাত্র সংসদ (চাকসু) হলো চট্টগ্রাম বিশ্ববিদ্যালয়ের শিক্ষার্থীদের সর্বোচ্চ প্রতিনিধিত্বকারী সংগঠন। এটি শিক্ষার্থীদের ন্যায্য অধিকার সংরক্ষণ, একাডেমিক মানোন্নয়ন, এবং বিশ্ববিদ্যালয়ের সার্বিক কল্যাণমূলক কার্যক্রমে গুরুত্বপূর্ণ ভূমিকা পালন করে আসছে।
                    </p>
                    <p class="fs-5 mb-0">
                        এই অনলাইন প্ল্যাটফর্মটি চাকসু নির্বাচনে অংশগ্রহণকারী প্রার্থীদের তথ্য এবং ইশতেহার প্রদর্শনের জন্য তৈরি করা হয়েছে, যাতে শিক্ষার্থীরা তাদের পছন্দের প্রার্থী সম্পর্কে সহজে এবং স্বচ্ছভাবে অবগত হতে পারে।
                    </p>
                </div>
            </div>
        </div>
    </section>

    <section class="text-center mb-5">
        <a href="{% url 'central' %}" 
           target="_blank" 
           rel="noopener noreferrer"
           class="btn btn-outline-primary">
            কেন্দ্রীয় সংসদ
            <i class="bi bi-box-arrow-up-right ms-1"></i>
        </a>
        <a href="{% url 'hall' %}" 
           target="_blank" 
           rel="noopener noreferrer"
           class="btn btn-outline-primary">
            হল সংসদ
            <i class="bi bi-box-arrow-up-right ms-1"></i>
        </a>
    </section>
    <section class="text-center mb-5">
        <a href="{% url 'candidate_form' %}" 
           target="_blank" 
           rel="noopener noreferrer"
           class="btn btn-outline-primary">
           নতুন প্রার্থী যুক্ত করুন 
           <i class="bi bi-person-plus ms-1"></i>
        </a>
       
    </section>

 


    <!-- Filter Section -->
    <section class="card shadow-sm border-0 university-card mb-5">
        <div class="card-body p-4">
            <form method="get" class="row g-3 align-items-end">
                <div class="col-12 col-md-8">
                    <label for="position" class="form-label fw-medium">পদ অনুযায়ী ফিল্টার করুন</label>
                    <select name="position" id="position" class="form-select university-select">
                        <option value="">-সকল পদ-</option>
                        {% for value, label in positions %}
                            <option value="{{ value }}" {% if selected_position == value %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

               

                <div class="col-6 col-md-2">
                    <button type="submit" class="btn btn-filter w-100">
                        {% comment %} <i class="bi bi-funnel me-1"></i> {% endcomment %}
                        <i class="bi bi-funnel me-1" 
                        style="background: linear-gradient(135deg, #ff7e5f, #feb47b, #86a8e7, #91eae4);
                               -webkit-background-clip: text;
                               -webkit-text-fill-color: transparent;
                               display: inline-block;">
                     </i>
                        ফিল্টার
                    </button>
                </div>

                <div class="col-6 col-md-2">
                    <a href="{% url 'home' %}" class="btn btn-reset w-100">
                        <i class="bi bi-arrow-clockwise me-1"></i>
                        রিসেট
                    </a>
                </div>
            </form>
        </div>
    </section>

    <!-- Candidates Grid -->
    <section class="row g-4 mb-5">
        {% for candidate in candidates %}
        <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
            <article class="card h-100 shadow-sm candidate-card university-card">
                <div class="card-header text-center bg-transparent border-0 pt-4">
                    <div class="position-relative d-inline-block">
                        <img src="{{ candidate.image.url }}" 
                             class="rounded-circle candidate-image shadow" 
                             style="width:120px; height:120px; object-fit:cover;"
                             alt="{{ candidate.name }}">
                        <div class="candidate-image-overlay"></div>
                    </div>
                </div>
                
                <div class="card-body">
                    <div class="candidate-info">
                        <div class="info-item mb-2">
                            <i class="bi bi-person-fill text-primary me-2"></i>
                            <span class="text-muted">নাম:</span>
                            <strong class="ms-1">{{ candidate.name }}</strong>
                        </div>
                        
                        <div class="info-item mb-2">
                            <i class="bi bi-building text-success me-2"></i>
                            <span class="text-muted">নির্বাচনের ধরন:</span>
                            <span class="badge bg-secondary ms-1">{{ candidate.get_election_type_display }}</span>
                        </div>
                        
                        <div class="info-item mb-2">
                            <i class="bi bi-people-fill text-warning me-2"></i>
                            <span class="text-muted">প্যানেল:</span>
                            <strong class="text-primary ms-1">{{ candidate.panel }}</strong>
                        </div>
                        
                        <div class="info-item mb-2">
                            <i class="bi bi-award text-info me-2"></i>
                            <span class="text-muted">পদ:</span>
                            <strong class="ms-1">{{ candidate.get_position_display }}</strong>
                        </div>
                        
                        <div class="info-item mb-0">
                            <i class="bi bi-card-checklist text-primary me-2"></i>
                            <span class="text-muted">ব্যালট নাম্বার:</span>
                            <span class="text-black bg-outline-primary ms-1">{{ candidate.ballot }}</span>
                        </div>
                        <div class="text-center mt-3">
                            <form class="vote-form" data-id="{{ candidate.id }}" action="{% url 'vote_candidate' candidate.id %}" method="POST">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-primary rounded-pill px-4">
                                    <i class="bi bi-heart-fill me-1"></i> Vote
                                    <span class="badge bg-light text-dark ms-2" id="vote-count-{{ candidate.id }}">
                                        {{ candidate.votes.count }}
                                    </span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div class="card-footer bg-transparent border-0 text-center pb-4">
                    <a href="{% url 'details' candidate.id %}" 
                       class="btn btn-details rounded-pill px-4">
                        বিস্তারিত
                        <i class="bi bi-arrow-right-circle ms-1"></i>
                    </a>
                </div>
            </article>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="bi bi-search display-1 text-muted mb-3"></i>
                <p class="fs-5 text-muted">
                    কোনো প্রার্থী পাওয়া যায়নি। অনুগ্রহ করে ফিল্টার রিসেট করুন।
                </p>
            </div>
        </div>
        {% endfor %}
    </section>

    <!-- Add Candidate Button -->
  

    <!-- External Link -->
    <section class="text-center mb-5">
        <a href="https://cucsu.cu.ac.bd/" 
           target="_blank" 
           rel="noopener noreferrer"
           class="btn btn-outline-primary">
            চট্টগ্রাম বিশ্ববিদ্যালয়ের অফিশিয়াল তথ্যকেন্দ্র
            <i class="bi bi-box-arrow-up-right ms-1"></i>
        </a>
    </section>


</div>
{% endblock %}


<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Load Notyf JS -->


<script>
$(document).ready(function() {
    const notyf = new Notyf({
        duration: 3000,
        position: { x: 'right', y: 'top' },
        dismissible: true
    });
    $(".vote-form").submit(function(e) {
        e.preventDefault(); 

        var form = $(this);
        var candidateId = form.data("id");

        $.ajax({
            url: form.attr("action"),
            type: "POST",
            headers: { "X-CSRFToken": "{{ csrf_token }}" },
            success: function(data) {
                if(data.success){
                    $("#vote-count-" + candidateId).text(data.votes_count);
                    alert("আপনার ভোট সফলভাবে দেওয়া হয়েছে!");
                    location.reload();
                } else {
                    notyf.error(data.message);
                }
            },
            error: function(xhr, status, error){
                notyf.error("একটি সমস্যা হয়েছে। আবার চেষ্টা করুন।");
            }
        });
    });
});
</script>

